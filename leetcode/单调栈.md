# å•è°ƒæ ˆ

- ä¼ªä»£ç 
```js
    const ans = [];
    const stack = []; // å•è°ƒæ ˆ
    for (let i = nums.length - 1; i >= 0; i--) { // ä»åå¾€å‰å–
        const cur = nums[i]; // å½“å‰å€¼
        while (stack.length && cur >= stack[stack.length - 1]) { // æ¯”å½“å‰å°çš„popï¼Œå…·ä½“çœ‹æ¡ä»¶
            stack.pop();
        }
        ans[i] = stack.length ? stack[stack.length - 1] : -1; // å–æ ˆé¡¶æˆ–è€… -1 || 0;
        stack.push(cur); // ç»§ç»­å…¥æ ˆ
    }
```

```js
// 496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I
// https://leetcode-cn.com/problems/next-greater-element-i/
// å“ˆå¸Œè®°å½•ä¸€ä¸€å¯¹åº”
// nums1Â ä¸­æ•°å­—Â xÂ çš„ ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  æ˜¯æŒ‡Â xÂ åœ¨Â nums2 ä¸­å¯¹åº”ä½ç½® å³ä¾§ çš„ ç¬¬ä¸€ä¸ª æ¯”Â xÂ å¤§çš„å…ƒç´ ã€‚
// ç»™ä½ ä¸¤ä¸ª æ²¡æœ‰é‡å¤å…ƒç´  çš„æ•°ç»„Â nums1 å’ŒÂ nums2 ï¼Œä¸‹æ ‡ä» 0 å¼€å§‹è®¡æ•°ï¼Œå…¶ä¸­nums1Â æ˜¯Â nums2Â çš„å­é›†ã€‚
// å¯¹äºæ¯ä¸ª 0 <= i < nums1.length ï¼Œæ‰¾å‡ºæ»¡è¶³ nums1[i] == nums2[j] çš„ä¸‹æ ‡ j ï¼Œå¹¶ä¸”åœ¨ nums2 ç¡®å®š nums2[j] çš„ ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  ã€‚å¦‚æœä¸å­˜åœ¨ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ï¼Œé‚£ä¹ˆæœ¬æ¬¡æŸ¥è¯¢çš„ç­”æ¡ˆæ˜¯ -1 ã€‚

var nextGreaterElement = function(nums1, nums2) {
    // å•è°ƒæ ˆ + å“ˆå¸Œ
    const stack = [];
    const map = new Map();
    for (let i = nums2.length - 1; i >= 0; i--) {
        const cur = nums2[i];
        while (stack.length && stack[stack.length - 1] < cur) {
            stack.pop();
        }
        map.set(cur, stack.length ? stack[stack.length - 1] : -1);
        stack.push(cur);
    }
    const ans = new Array(nums1.length).fill(0).map((_, index) => map.get(nums1[index]));
    return ans;
}



// 503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II
// https://leetcode-cn.com/problems/next-greater-element-ii/
// [...nums, ...nums] æ„æˆå¾ªç¯, å† return ans.slice(0, nums.length); å–ç­”æ¡ˆ
// ç»™å®šä¸€ä¸ªå¾ªç¯æ•°ç»„Â numsÂ ï¼ˆÂ nums[nums.length - 1]Â çš„ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯Â nums[0]Â ï¼‰ï¼Œè¿”å›Â numsÂ ä¸­æ¯ä¸ªå…ƒç´ çš„ ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  ã€‚
// æ•°å­— xÂ çš„ ä¸‹ä¸€ä¸ªæ›´å¤§çš„å…ƒç´  æ˜¯æŒ‰æ•°ç»„éå†é¡ºåºï¼Œè¿™ä¸ªæ•°å­—ä¹‹åçš„ç¬¬ä¸€ä¸ªæ¯”å®ƒæ›´å¤§çš„æ•°ï¼Œè¿™æ„å‘³ç€ä½ åº”è¯¥å¾ªç¯åœ°æœç´¢å®ƒçš„ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¾“å‡º -1Â ã€‚

/**
 * @param {number[]} nums
 * @return {number[]}
 */
var nextGreaterElements = function(nums) {
    // å•è°ƒæ ˆ
    const arr = [...nums, ...nums];
    const ans = [];
    const stack = [];
    for (let i = arr.length - 1; i >= 0; i--) {
        const cur = arr[i];
        while (stack.length && cur >= stack[stack.length - 1]) {
            stack.pop();
        }
        ans[i] = stack.length ? stack[stack.length - 1] : -1;
        stack.push(cur);
    }
    return ans.slice(0, nums.length);
};

// 1475. å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼
// https://leetcode-cn.com/problems/final-prices-with-a-special-discount-in-a-shop/

// ç»™ä½ ä¸€ä¸ªæ•°ç»„Â pricesÂ ï¼Œå…¶ä¸­Â prices[i]Â æ˜¯å•†åº—é‡Œç¬¬Â iÂ ä»¶å•†å“çš„ä»·æ ¼ã€‚
// å•†åº—é‡Œæ­£åœ¨è¿›è¡Œä¿ƒé”€æ´»åŠ¨ï¼Œå¦‚æœä½ è¦ä¹°ç¬¬Â iÂ ä»¶å•†å“ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¾—åˆ°ä¸ prices[j] ç›¸ç­‰çš„æŠ˜æ‰£ï¼Œå…¶ä¸­Â jÂ æ˜¯æ»¡è¶³Â j > iÂ ä¸”Â prices[j] <= prices[i]Â çš„Â æœ€å°ä¸‹æ ‡Â ï¼Œå¦‚æœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„Â jÂ ï¼Œä½ å°†æ²¡æœ‰ä»»ä½•æŠ˜æ‰£ã€‚
// è¯·ä½ è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­ç¬¬Â iÂ ä¸ªå…ƒç´ æ˜¯æŠ˜æ‰£åä½ è´­ä¹°å•†å“ iÂ æœ€ç»ˆéœ€è¦æ”¯ä»˜çš„ä»·æ ¼ã€‚

/**
 * @param {number[]} prices
 * @return {number[]}
 */
var finalPrices = function(prices) {
    // å•è°ƒæ ˆ
    const ans = [];
    const stack = [];
    for (let i = prices.length - 1; i >= 0; i--) {
        const cur = prices[i];
        // å°äºå°±å‡ºæ ˆï¼Œ å¤§äºç­‰äºå°±ç•™ç€æ‰“æŠ˜æ‰£
        while (stack.length && cur < stack[stack.length - 1]) {
            stack.pop();
        }
        ans[i] = stack.length ? cur - stack[stack.length - 1] : cur;
        stack.push(cur);
    }
    return ans;
};


// 739. æ¯æ—¥æ¸©åº¦
// https://leetcode-cn.com/problems/daily-temperatures/
// stackå­˜æ¸©åº¦çš„ä¸‹æ ‡ï¼Œansèµ‹å€¼çš„æ—¶å€™ç›´æ¥å‡æ±‚ç»“æœ
// ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„Â temperaturesÂ ï¼Œè¡¨ç¤ºæ¯å¤©çš„æ¸©åº¦ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„Â answerÂ ï¼Œå…¶ä¸­Â answer[i]Â æ˜¯æŒ‡åœ¨ç¬¬ i å¤©ä¹‹åï¼Œæ‰ä¼šæœ‰æ›´é«˜çš„æ¸©åº¦ã€‚å¦‚æœæ°”æ¸©åœ¨è¿™ä¹‹åéƒ½ä¸ä¼šå‡é«˜ï¼Œè¯·åœ¨è¯¥ä½ç½®ç”¨Â 0 æ¥ä»£æ›¿ã€‚
ğŸŒ°1
è¾“å…¥: temperatures = [73,74,75,71,69,72,76,73]
è¾“å‡º: [1,1,4,2,1,1,0,0]

/**
 * @param {number[]} temperatures
 * @return {number[]}
 */
var dailyTemperatures = function(temperatures) {
    // å•è°ƒæ ˆ
    const ans = [];
    const stack = [];
    for (let i = temperatures.length - 1; i >= 0; i--) {
        const cur = temperatures[i];
        while (stack.length && cur >= stack[stack.length - 1][0]) {
            stack.pop();
        }
        ans[i] = stack.length ? stack[stack.length - 1][1] - i : 0;
        stack.push([cur, i]);
    }
    return ans;
};

// 1019. é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªæ›´å¤§èŠ‚ç‚¹
// https://leetcode-cn.com/problems/next-greater-node-in-linked-list/
// ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºÂ nÂ çš„é“¾è¡¨Â head
// å¯¹äºåˆ—è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾ä¸‹ä¸€ä¸ª æ›´å¤§èŠ‚ç‚¹ çš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œæ‰¾åˆ°å®ƒæ—è¾¹çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„å€¼ ä¸¥æ ¼å¤§äº å®ƒçš„å€¼ã€‚
// è¿”å›ä¸€ä¸ªæ•´æ•°æ•°ç»„ answer ï¼Œå…¶ä¸­ answer[i] æ˜¯ç¬¬ i ä¸ªèŠ‚ç‚¹( ä»1å¼€å§‹ )çš„ä¸‹ä¸€ä¸ªæ›´å¤§çš„èŠ‚ç‚¹çš„å€¼ã€‚å¦‚æœç¬¬ i ä¸ªèŠ‚ç‚¹æ²¡æœ‰ä¸‹ä¸€ä¸ªæ›´å¤§çš„èŠ‚ç‚¹ï¼Œè®¾ç½®Â answer[i] = 0Â ã€‚

/**
 * Definition for singly-linked list.
 * function ListNode(val, next) {
 *     this.val = (val===undefined ? 0 : val)
 *     this.next = (next===undefined ? null : next)
 * }
 */
/**
 * @param {ListNode} head
 * @return {number[]}
 */
var nextLargerNodes = function(head) {
    // å•è°ƒæ ˆ
    const arr = [];
    while (head) {
        arr.push(head.val);
        head = head.next;
    }
    const ans = [], stack = [];
    for (let i = arr.length - 1; i >= 0; i--) {
        const cur = arr[i];
        while (stack && cur >= stack[stack.length - 1]) {
            stack.pop();
        }
        ans[i] = stack.length ? stack[stack.length - 1] : 0;
        stack.push(cur);
    }
    return ans;
};



// 769. æœ€å¤šèƒ½å®Œæˆæ’åºçš„å—â‘  medium
// https://leetcode-cn.com/problems/max-chunks-to-make-sorted/
// ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°æ•°ç»„ arr ï¼Œå®ƒè¡¨ç¤ºåœ¨ [0, n - 1] èŒƒå›´å†…çš„æ•´æ•°çš„æ’åˆ—ã€‚
// æˆ‘ä»¬å°† arr åˆ†å‰²æˆè‹¥å¹² å— (å³åˆ†åŒº)ï¼Œå¹¶å¯¹æ¯ä¸ªå—å•ç‹¬æ’åºã€‚å°†å®ƒä»¬è¿æ¥èµ·æ¥åï¼Œä½¿å¾—è¿æ¥çš„ç»“æœå’ŒæŒ‰å‡åºæ’åºåçš„åŸæ•°ç»„ç›¸åŒã€‚
// è¿”å›æ•°ç»„èƒ½åˆ†æˆçš„æœ€å¤šå—æ•°é‡ã€‚

/**
 * @param {number[]} arr
 * @return {number}
 */
var maxChunksToSorted = function(arr) {
    // å•è°ƒæ ˆ
    // 1. åä¸€ä¸ªå—é‡Œçš„æœ€å°å€¼ å¤§äº å‰ä¸€ä¸ªå—çš„æœ€å¤§å€¼
    // 2. å¾ªç¯éå†æ•°ç»„ï¼Œå…ˆå‡è®¾æ¯ä¸€ä¸ªå…ƒç´ éƒ½èƒ½ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å—ï¼Œpush åˆ°æ ˆé‡Œ
    // 3. æ•´ä¸ªè¿‡ç¨‹è®°å½•ä¸‹ æ ˆé¡¶çš„æœ€å¤§å€¼
    // 4. å½“é‡åˆ°å°äºæ ˆé¡¶çš„å€¼æ—¶ï¼Œå°±éœ€è¦å…ˆ pop å‡ºæ ˆï¼Œç›´åˆ°æ‰¾åˆ°å¤§äºå®ƒçš„å€¼ï¼Œè€Œè¿‡ç¨‹ä¸­ pop å‡ºå»çš„å…ƒç´ ä¹Ÿæ˜¯å¯ä»¥ä¸¢å¼ƒçš„ï¼Œ
    // å› ä¸ºå®ƒä»¬éƒ½åœ¨è¿™ä¸¤ä¸ªå€¼èŒƒå›´å†…ï¼Œä¸”ä¸€å®šæ˜¯å±äºä¸€ä¸ªå—çš„
    const stack = [];
    let max = -1;
    for (const num of arr) {
        if (num > max) {
            max = num;
            stack.push(num);
        } else {
            while (stack.length && num < stack[stack.length - 1]) {
                stack.pop();
            }
            stack.push(max);
        }
    }
    return stack.length;

    // è´ªå¿ƒ
    //å½“éå†åˆ°ç¬¬iä¸ªä½ç½®æ—¶ï¼Œå¦‚æœå¯ä»¥åˆ‡åˆ†ä¸ºå—ï¼Œé‚£å‰iä¸ªä½ç½®çš„æœ€å¤§å€¼ä¸€å®šç­‰äºiã€‚
    //å¦åˆ™ï¼Œä¸€å®šæœ‰æ¯”iå°çš„æ•°åˆ’åˆ†åˆ°åé¢çš„å—ï¼Œé‚£å—æ’åºåï¼Œä¸€å®šä¸æ»¡è¶³å‡åºã€‚
    let max = 0;
    let count = 0;
    for(let i = 0; i<arr.length; i++) {
        max = Math.max(arr[i], max); //ç»Ÿè®¡å‰iä¸ªä½ç½®çš„æœ€å¤§å…ƒç´ 
        if(max === i) count++;
    }
    return count;
};


// 768. æœ€å¤šèƒ½å®Œæˆæ’åºçš„å— II hard ç›¸å¯¹äº 769åªæ˜¯ cur > max å˜æˆ cur >= max
// https://leetcode-cn.com/problems/max-chunks-to-make-sorted-ii/
// è¿™ä¸ªé—®é¢˜å’Œâ€œæœ€å¤šèƒ½å®Œæˆæ’åºçš„å—â€ç›¸ä¼¼ï¼Œä½†ç»™å®šæ•°ç»„ä¸­çš„å…ƒç´ å¯ä»¥é‡å¤ï¼Œè¾“å…¥æ•°ç»„æœ€å¤§é•¿åº¦ä¸º2000ï¼Œå…¶ä¸­çš„å…ƒç´ æœ€å¤§ä¸º10**8ã€‚
// arræ˜¯ä¸€ä¸ªå¯èƒ½åŒ…å«é‡å¤å…ƒç´ çš„æ•´æ•°æ•°ç»„ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªæ•°ç»„åˆ†å‰²æˆå‡ ä¸ªâ€œå—â€ï¼Œå¹¶å°†è¿™äº›å—åˆ†åˆ«è¿›è¡Œæ’åºã€‚ä¹‹åå†è¿æ¥èµ·æ¥ï¼Œä½¿å¾—è¿æ¥çš„ç»“æœå’ŒæŒ‰å‡åºæ’åºåçš„åŸæ•°ç»„ç›¸åŒã€‚
// æˆ‘ä»¬æœ€å¤šèƒ½å°†æ•°ç»„åˆ†æˆå¤šå°‘å—ï¼Ÿ

ğŸŒ°1
è¾“å…¥: arr = [5,4,3,2,1]
è¾“å‡º: 1
è§£é‡Š:
å°†æ•°ç»„åˆ†æˆ2å—æˆ–è€…æ›´å¤šå—ï¼Œéƒ½æ— æ³•å¾—åˆ°æ‰€éœ€çš„ç»“æœã€‚
ä¾‹å¦‚ï¼Œåˆ†æˆ [5, 4], [3, 2, 1] çš„ç»“æœæ˜¯ [4, 5, 1, 2, 3]ï¼Œè¿™ä¸æ˜¯æœ‰åºçš„æ•°ç»„ã€‚ 

ğŸŒ°2
è¾“å…¥: arr = [2,1,3,4,4]
è¾“å‡º: 4
è§£é‡Š:
æˆ‘ä»¬å¯ä»¥æŠŠå®ƒåˆ†æˆä¸¤å—ï¼Œä¾‹å¦‚ [2, 1], [3, 4, 4]ã€‚
ç„¶è€Œï¼Œåˆ†æˆ [2, 1], [3], [4], [4] å¯ä»¥å¾—åˆ°æœ€å¤šçš„å—æ•°ã€‚ 

/**
 * @param {number[]} arr
 * @return {number}
 */
// 1. åä¸€ä¸ªå—é‡Œçš„æœ€å°å€¼ å¤§äº å‰ä¸€ä¸ªå—çš„æœ€å¤§å€¼
// 2. å¾ªç¯éå†æ•°ç»„ï¼Œå…ˆå‡è®¾æ¯ä¸€ä¸ªå…ƒç´ éƒ½èƒ½ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å—ï¼Œpush åˆ°æ ˆé‡Œ
// 3. æ•´ä¸ªè¿‡ç¨‹è®°å½•ä¸‹ æ ˆé¡¶çš„æœ€å¤§å€¼
// 4. å½“é‡åˆ°å°äºæ ˆé¡¶çš„å€¼æ—¶ï¼Œå°±éœ€è¦å…ˆ pop å‡ºæ ˆï¼Œç›´åˆ°æ‰¾åˆ°å¤§äºå®ƒçš„å€¼ï¼Œè€Œè¿‡ç¨‹ä¸­ pop å‡ºå»çš„å…ƒç´ ä¹Ÿæ˜¯å¯ä»¥ä¸¢å¼ƒçš„ï¼Œå› ä¸ºå®ƒä»¬éƒ½åœ¨è¿™ä¸¤ä¸ªå€¼èŒƒå›´å†…ï¼Œä¸”ä¸€å®šæ˜¯å±äºä¸€ä¸ªå—çš„
// 1,1,5,6,7,4
// 1,1,7
var maxChunksToSorted = function(arr) {
    const stack = [];
    let max = -1;
    for (const num of arr) {
        if (num >= max) {
            max = num;
            stack.push(num);
        } else {
            while (stack.length && num < stack[stack.length - 1]) {
                stack.pop();
            }
            stack.push(max);
        }
    }
    return stack.length;
};


```
